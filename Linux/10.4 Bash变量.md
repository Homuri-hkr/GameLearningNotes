### 10.4 Bash变量

变量设置规则

- 变量名称可以由字母、数字、下划线组成，但是不能以数字开头
- 变量的默认类型都是字符串类型，如果要进行数值运算，则必须制定变量类型为数值型
- 变量用等号连接值，等号左右两侧不能有空格
- 变量的值如果有空格，需要使用单引号或双引号包括
- 在变量的值中，可以使用\转义符
- 如果需要增加变量的值，可以进行变量的叠加，不过需要用"$变量名"或${变量名}包含
- 如果是把命令的结果作为变量值赋予变量，则需要使用反引号或$()包含命令
- 环境变量名建议大写，便于区分

变量分类：

- 用户自定义变量
- 环境变量：主要保存的是和系统操作环境相关的数据                                                         
- 位置参数变量：这种变量主要是用来向脚本中传递参数或数据的，变量名不能自定义，变量作用是固定的，不能新增但值可以改变，是预定义变量中的一种
- 预定义变量：是Bash中已经定义好的变量，变量名不能自定义，变量作用也是固定的

**用户自定义变量（本地变量）：**

变量定义：name="zy"

变量叠加：name="z";	name="$name"y;		name=${name}121

变量调用：echo $name

变量查看（查看所有）：set

变量删除：unset name

**环境变量：**

用户自定义变量只在当前的Shell中生效，而环境变量会在当前Shell和这个Shell的所有子Shell中生效，如果把环境变量写入相应的配置文件，那么这个环境变量就会在所有的Shell中生效

变量声明：export 变量名=变量值

查询变量：env

删除变量：unset 变量名

系统常见环境变量：

PATH：系统查找命令的路径		变量叠加：PATH="$PATH":路径

PS1：定义系统提示符的变量

| 提示符 | 作用                                       |
| ------ | ------------------------------------------ |
| \d     | 显示日期，格式：“星期 月 日”               |
| \h     | 显示简写主机名                             |
| \t     | 显示24小时制时间，格式”HH：MM：SS“         |
| \T     | 显示12小时制时间，格式：”HH：MM：SS“       |
| \A     | 显示24小时制时间，格式：”HH：MM“           |
| \u     | 显示当前用户名                             |
| \w     | 显示当前所在目录的完整名称                 |
| \W     | 显示当前所在目录的最后一个目录             |
| \\#    | 执行的第几个命令                           |
| \\$    | 提示符，若果是root用户显示#，普通用户显示$ |

**位置参数变量**

| 位置参数变量 | 作用                                                         |
| ------------ | ------------------------------------------------------------ |
| $n           | n为数字，$0表示命令本身，\$1-\$9代表第一个到第九个参数，十个以上用{}包含 |
| $*           | 代表命令行中所有参数，且把所有参数看成整体                   |
| $@           | 代表命令行中所有参数，但把每个参数区分对待                   |
| $#           | 代表命令行中所有参数的个数                                   |

**预定义变量**

| 预定义变量 | 作用                                                         |
| ---------- | ------------------------------------------------------------ |
| $?         | 最后一次执行的命令返回状态，值为0则上个命令正确执行，非0则上个命令未正确执行（具体值人为决定） |
| $$         | 当前进程的进程号                                             |
| $!         | 后台运行的最后一个进程的进程号                               |

接受键盘输入：

read [选项] [变量名]

-p "提示信息"：在等待read输入时，输出提示信息

-t 描述：指定等待输入的时间

-n 字符数：只接受指定的字符数，接受到就会执行

-s ：隐藏输入的数据，适用于机密信息的输入

**数值运算和运算符**

声明变量：declare [+/-] [选项] 变量名

-：给变量设定类型属性

+：取消变量的类型属性

-i：将变量声明为整数型

-x：将变量声明为环境变量

-p：显示指定变量的被声明的类型

进行数值运算的方法：

- declare -i c = \$a+\$b
- c=$(expr \$a+\$b)
- c=$((\$a+\$b))

bash支持算术运算，逻辑运算，位运算，而且在bash中0表示false，1表示true

**变量置换方式**

| 变量置换方式 | y值没有设置        | y为空值            | y设置值       |
| ------------ | ------------------ | ------------------ | ------------- |
| x=${y-新值}  | x=新值             | x为空              | x=$y          |
| x=${y:-新值} | x=新值             | x=新值             | x=$y          |
| x=${y+新值}  | x为空              | x=新值             | x=新值        |
| x=${y:+新值} | x为空              | x为空              | x=新值        |
| x=${y=新值}  | x=新值，y=新值     | x为空，y不变       | x=$y，y值不变 |
| x=${y:=新值} | x=新值，y=新值     | x=新值，y=新值     | x=$y，y值不变 |
| x=${y?新值}  | 新值输出到标准错误 | x为空              | x=$y          |
| x=${y:?新值} | 新值输出到标准错误 | 新值输出到标准错误 | x=$y          |

