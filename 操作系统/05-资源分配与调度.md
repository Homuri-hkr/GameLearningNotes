### 5.1 资源管理概述

- 资源的分配方法：
  - 静态分配：在作业被调度时，根据用户给出的信息进行分配，并在作业运行完毕有释放锁获得的全部资源
  - 动态分配：进程所需的资源是在进程运行中根据运行情况动态的分配、使用和释放

### 5.2 资源管理的机制和策略

- 资源分配策略：
  1. 先请求先服务：队列按提出请求的先后次序排序，每一个新产生的请求均排在队尾，当资源可用时，资源分配程序则从队列中选取第一个请求并满足其需要
  2. 优先调度：进程调度队列按进程的优先级由高到低的顺序排列，队首为优先级最高者，当某一进程要入队时，按其优先级的高低插到相应的位置。可以按单队列或多队列实现
  3. 针对设备特性的调度：
     - 移臂调度：总是选取与当前移动臂前进方向上最近的那个请求，使移臂距离最短
     - 旋转调度：总是选取与当前读写头旋转方向上最近的那个请求，使旋转圏数最少
- 移臂调度算法：
  - 最短寻道时间优先：总是从等待访问这种挑选寻找时间最短的那个请求先执行
  - 扫描算法：从移动臂当前位置开始，沿着臂的移动方向去选择离当前移动臂最近的那个柱面访问者，若沿臂的移动方向无请求访问时，就改变臂的移动方向再选择。
  - 循环扫描算法：在上面的基础上，磁头只做单向移动不做往返移动

### 5.3 死锁

- 两个或多个进程被无限期的阻塞相互等待的状态

- 死锁的必要条件：

  - 互斥：一个资源只能由有限个进程使用
  - 不剥夺：进程获得的资源在未使用完毕之前不能被其他进程强行夺走
  - 占有并等待：等待新资源的同时，占用已分配的资源
  - 环路等待：存在一个循环链，里面每个进程已获得的资源同时被下一个进程所请求

- 资源分配图：系统活动进程集合描述为P={p1,p2,p3...}，所有资源类型集合描述为R={r1，r2，r3...}，进程i等待资源j记为pi->rj，资源j分配给进程i记为rj->pi，若形成环路，则发生死锁

- 解决死锁的策略：破除四个必要条件之一。

  - 互斥：此阿勇虚拟设备技术排除非共享设备死锁的可能性
  - 不剥夺：某进程的资源被拒绝时，必须释放所有已获得的资源
  - 占有并等待：各进程所需要的全部资源一次申请，并在没有获得全部资源前，不能投入运行
  - 环路等待：进行资源分配时检查资源分配图中是否产生环路

- 死锁的静态预防：在应用程序进入系统时，采用预先分配所有共享资源的方法，满足所需的全部资源才开始调用。

  缺点：

  - 一个用户在作业运行之前可能提不出将要使用的全部设备
  - 用户作业的所有资源满足后才能投入运行，实际上某些资源要运行后期才会用到
  - 一个作业运行期间某些设备使用时间很少

- 死锁的动态避免：

  1. 有序分配法：为系统中每一类资源分配唯一的号码，要求进程对它所必需使用的而且属于某一类的所有资源一次申请玩，在申请不同类资源时必须按各类的编号依次申请
  2. 银行家算法：当进程申请一组资源时，检查申请者对各类资源最大需求量，若系统现存的各类资源的数量可以满足当前它对各类资源的最大需求量，就满足当前申请，否则等待其他进程释放足够的资源为止

- 死锁的检测：找到对各类申请资源小于系统现在所拥有的各类资源数目的进程，认为其可以运行完释放，然后资源数目增加，这样的加入到可运行结束的进程序列中，然后接着考查，直到存在几个进程不能加入到序列为止

- 死锁的忽略：不管死锁，当处于死锁时人工抽去一部分程序，释放所占用资源，然后重启系统