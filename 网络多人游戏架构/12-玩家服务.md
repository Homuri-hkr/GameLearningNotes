### 12.1 选择一种玩家服务

- 某些情况下，游戏发布的平台已经做出了选择，如所有XboxOne游戏必须集成XboxLive玩家服务。对于PC、Mac、Linux有几种可能的选择。当前最流行的服务是Steam
- 将Steam整合到游戏中有几个先决条件：
  1. 必须统一Steamworks SDK接入协议的条款
  2. 必须注册为Steamworks的合作伙伴，包括签订进一步的保密协议并提供相关信息
  3. 必须获得游戏的应用程序ID

### 12.2 基本设置

- 在给玩家服务写任何具体代码前要考虑如何将该代码继承到游戏中
- 一种快速的方法是在需要的时候直接添加玩家服务代码的调用，但不建议这么做，这一位这团队的每个开发者都需要在一定程度上熟悉Steamworks，也使得在游戏中继承另一个不同的玩家服务变的非常困难，对于跨平台游戏而言是特别关注的问题
- 一个设计思想是通过指向实现的指针，有一个类包含实现类的前向声明和指向这个实现类的指针，通过该方式，类的实现细节和声明就分开了。当想集成另一个玩家服务时，只需要创建另一个该类的实现。但当使用指向实现的指针时，意味着该对象大量的成员函数调用都需要额外的指针引用，其有一定的开销，对于又大量成员函数调用的类性能降低是非常明显的，对于玩家服务来说每帧没有特别多的函数调用，因此为了灵活性降低一点性能是可以接受的

#### 12.2.1 初始化、运行和关闭

- 通过SteamAPI_Init初始化Steamworks，返回bool表示初始化是否成功
- Steam提供特色功能跟之一是叠加，其允许玩家在没有离开当前游戏的情况下执行一些动作，如聊天等，该叠加通过挂钩在OpenGL功能上工作，所以为保证叠加渲染正常必须在渲染初始化之前调用SteamAPI_Init
- 通常情况下，Steam上的游戏是通过Steam客户端启动的，通过该方法Steamworkds可以知道正在运行游戏的应用程序ID。但开发时不会通过Steam启动，为了让Steamworks在开发时知道应用程序ID，将包含应用程序ID的steam_appid.txt文件存放在可执行程序同一目录下，虽然这样不需要通过Steam客户端来启动游戏，但比如运行有用户登录的Steam客户端实例
- 为了在Steam上测试多用户游戏，必须创建多个测试账号
- 因为Steamworks需要经常与远程服务器通信，所以许多函数调用是异步的，为了完成异步调用后通知应用程序，Steamworks使用回调，为了确保回调被触发，游戏必须定期调用SteamAPI_RunCallbacks，建议每帧调用一次
- Steamworks关闭直接通过调用SteamAPI_Shutdown函数

#### 12.2.2 用户ID和名称

- 

### 12.3 游戏大厅和比赛安排

- 准备通过Steamworks进行多人游戏的基本流程大致如下：
  1. 游戏基于应用自定义的参数搜索游戏大厅，包括游戏模式、玩家等级等
  2. 若找到一个或多个合适的游戏大厅，游戏可以自动选择一个，也可以让玩家从列表中选择，若没找到游戏可以为玩家创建一个
  3. 在游戏大厅中，有可能进一步配置即将开始的游戏参数，如角色、地图等。当在同一个大厅时可以互相发送聊天消息
  4. 一旦游戏准备启动，玩家会加入游戏并离开大厅，一般情况下涉及与游戏服务器的连接